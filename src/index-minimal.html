<!-- GUIEasy  Copyright (C) 2019-2020  Jimmy "Grovkillen" Westberg -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="theme-color" content="#000000">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link id="favicon" rel="shortcut icon" type="image/png" href="data:image/png;base64,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">
    <title>ESP Easy</title>
    <style>
        :root {
            --frontend-color: 0, 255, 45;
            --backend-color: 100, 200, 245;
            /*--color: var(--frontend-color);*/
            --color-1: rgb(var(--color));
            --color-2: rgba(var(--color), 0.4);
        }
        ::-webkit-scrollbar:window-inactive,
        ::-webkit-scrollbar {
            width: 5px;
            height: 5px;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-1);
        }
        body {
            color: var(--color-1);
            background: black;
            font-family: monospace;
            text-align: justify;
            font-size: 1.1em;
            scrollbar-color: var(--color-2) var(--color-2); /* thumb and track color */
            scrollbar-width: thin;
        }
        button{
             display: none;
             width: 100%;
             border-color: var(--color-1);
             border-style: solid;
             border-width: 1px;
             color: var(--color-1);
             background: transparent;
             align-items: center;
             justify-content: center;
             cursor: pointer;
             outline: 0;
             padding: .65em 2em;
             font-family: inherit;
        }
        button.active {
            background-color: var(--color-2);
        }
        select {
            display: none;
            width: 100%;
            border-color: var(--color-1);
            border-style: solid;
            border-width: 1px;
            color: var(--color-1);
            background: transparent;
            text-align-last: center;
            text-align: center;
            cursor: pointer;
            outline: 0;
            padding: .65em 2em;
            font-family: inherit;
        }
        select option {
            transition: 250ms;
            background: black;
            color: var(--color-1);
        }
        select option:hover {
            color: black;
            background-color: var(--color-1);
        }
        select option:checked {
            background: linear-gradient(to bottom, var(--color-1) 0%, var(--color-1) 100%);
        }
        #x {
            min-width: 250px;
            max-width: 250px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        #a {
            display: none;
            margin-top: 10px;
            margin-bottom: 10px;
        }
        #p {
            background-color: var(--color-1);
            height: 3px;
            margin-bottom: 10px;
        }
        #t {
            display: none;
            margin-top: 10px;
            margin-bottom: 10px;
        }
    </style>
    <script>
        let releases = {};
        releases.frontend = {
            "b": "Make This Drone A Queen",
            "a": "Select version in the dropdown below (latest is always first):",
            "url": "https://raw.githubusercontent.com/letscontrolit/GUIEasy/master/build/releases.txt",
            "t": "Click the button below to upgrade this unit to Queen status."
        };
        releases.backend = {
            "b": "Update Firmware",
            "a": "Select version in the dropdown below (latest is always first):",
            "url": "https://raw.githubusercontent.com/letscontrolit/GUIEasy/master/build/releases.txt",
            "t": "Click the button below to upgrade this unit to selected firmware version."
        };
        let fe, be, r, rc, n, t, d, b, a, p;

        start = async function (type) {
            fe = document.getElementById("fe"); //front end button
            be = document.getElementById("be"); //back end button
            r = document.getElementById("r"); //filter release button
            rc = document.getElementById("rc"); //filter release candidates button
            n = document.getElementById("n"); //filter nightlies button
            t = document.getElementById("t"); //text
            d = document.getElementById("d"); //select
            b = document.getElementById("b"); //button
            a = document.getElementById("a"); //ascii dude
            p = document.getElementById("p"); //progress bar
            //------------
            fe.style.display = "none";
            be.style.display = "none";
            d.style.display = "none";
            b.style.display = "none";
            a.style.display = "none";
            t.style.display = "none";
            r.style.display = "none";
            rc.style.display = "none";
            n.style.display = "none";
            //------------
            p.style.width = "0";
            document.documentElement.style.setProperty("--color", "var(--" + type + "-color)");
            filter('r');
            if (window.navigator.onLine === true) {
                //It's ok to download
                //TODO: have an external js that look if mem will fit the gui etc. etc.
                d.innerHTML = "";
                releases.list = await fetchReleases(type);
                releases.list.reverse();
                for (let i = 0; i < releases.list.length; i++) {
                    if (releases.list[i] === "") {
                        continue;
                    }
                    let option = document.createElement("option");
                    option.text = releases.list[i];
                    option.value = releases.list[i];
                    d.add(option);
                }
                d.onfocus=function () {
                    d.size = 10;
                    d.style.fontSize = "1.5em";
                    d.style.padding = "0";
                };
                d.onchange=function () {
                    d.size = 1;
                    d.blur();
                };
                d.onblur=function () {
                    d.size = 0;
                    d.style.fontSize = "unset";
                    d.style.padding = ".65em 2em";
                };
                t.innerHTML = releases[type].t;
                if (type === "frontend") {
                    fe.classList.add("active");
                    be.classList.remove("active");
                } else {
                    fe.classList.remove("active");
                    be.classList.add("active");
                }
                fe.style.display = "flex";
                be.style.display = "flex";
                r.style.display = "flex";
                rc.style.display = "flex";
                n.style.display = "flex";
                d.style.display = "block";
                b.style.display = "block";
                a.style.display = "block";
                t.style.display = "block";
                a.innerHTML = releases[type].a;
                b.innerHTML = releases[type].b;
            } else {
                //Cannot download
                t.innerHTML = "No Internet connection. Please connect to Internet to download graphical user interface - OR - browse to a Queen.";
                t.style.color = "red";
                t.style.display = "block";
                a.style.color = "red";
                a.style.display = "block";
            }
        };
        filter = function (type) {
            r.classList.remove("active");
            rc.classList.remove("active");
            n.classList.remove("active");
            document.getElementById(type).classList.add("active");
        };
        fetchReleases = async function (type) {
            let rl = "";
            let timeStart = Date.now();
            const releaseList = releases[type].url + "?callback=" + timeStart;
            await fetch(releaseList)
                .then(res => res.text())
                .then((list) => {
                    rl = list.split(/\n/);
                })
                .catch(error => {
                    console.warn('Error fetching releases: ' + error, 0, "error");
                });
            return rl;
        };
        download = function () {
            p.style.width = "20%";
        };
    </script>
</head>
<body onload="start('frontend')">
<!-- This file is used as a minimum GUI to download the GUI from GitHub -->
<!-- Since Butler is used, do not rename or move the file /src/gui_easy_butler_gui_update.js !! -->
<div id="x">
    <div style="width:100%; display:inline-flex;">
        <button id="fe" style="width:50%;" onclick="start('frontend')">Front End</button>
        <button id="be" style="width:50%;" onclick="start('backend')">Back End</button>
    </div>
    <div id="a">
        &nbsp;&nbsp;&nbsp;UR ASCIIN 4 IT!<br>
        &nbsp;&nbsp;&nbsp;&nbsp;/<br>
        &nbsp;&nbsp;,﹏<br>
        (҂॰ᨓ॰)<br>
        &nbsp;(ϑ͏  ꙻ)ϑ͏<br>
        &nbsp;√ ㄟ<br><br>
    </div>
    <div style="width:100%; display:inline-flex;">
        <button id="r" style="width:40%;" onclick="filter('r')">Release</button>
        <button id="rc" style="width:30%;" onclick="filter('rc')">RC</button>
        <button id="n" style="width:30%;" onclick="filter('n')">Nightly</button>
    </div>
    <label for="d"></label>
    <select id="d"></select>
    <label for="dopt"></label>
    <select id="dopt"></select>
    <div id="t"></div>
    <button onclick="download()" id="b"></button>
    <div id="p"></div>
</div>
</body>
</html>